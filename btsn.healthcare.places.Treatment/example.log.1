INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1030001 buffered at T_in_TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1030001 eventType=BUFFERED
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1030001  -> TreatmentService [BUFFERED] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1030001 BUFFERED at TreatmentService (T_in arrival)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1030001 entering place: TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1030001 eventType=ENTER
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1030001  -> TreatmentService [ENTER] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1030001 ENTER at TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service TreatmentService:executeTreatmentPlan executing with trigger token (no workflow data required)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling TreatmentService.executeTreatmentPlan immediately
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking TreatmentService.executeTreatmentPlan via ServiceHelper (canonical binding)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SequenceID: 1030000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 1195
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Unwrapped place response from key: DIAGNOSIS_PLACE_1030001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Found existing original_token to preserve
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770257244256
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 1195 (removed 0 bytes of metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.TreatmentService.executeTreatmentPlan with 1 CLEAN business data arguments
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.TreatmentService
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Calling executeTreatmentPlan with 1 arguments
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.TreatmentService.executeTreatmentPlan completed in 1120ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Using wrapped response key 'TREATMENT_PLACE_1030000' instead of 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"TREATMENT_PLACE_1030000":{"serviceType":"treatmentResults","notAfter":1770260854347,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:37","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120737_1908","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"SIGNIFICANT - Pain resolved, breathing easier","protocol_id":"GENERAL_TREATMENT_01","overall_response":"EXCELLENT - Treatment goals being met","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","discharge_ready":"true","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257244256,"placeId":"TREATMENT_PLACE_1030000","service_start_time":1770257256182,"version":"v001","sequenceId":"1030000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":1120,"original_token":"{\"notAfter\":1770257364256,\"tokenId\":\"1030000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1030000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257244256,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257257302,"status":"TREATMENT_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1030001 exiting place: TreatmentService -> MonitorService [arc=$ANON11]
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_TreatmentService token=1030001 eventType=EXIT
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_TreatmentService (EdgeNode) token=1030001 TreatmentService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1030001 EXIT from TreatmentService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: Token 1030001 -> 'treatmentResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute treatmentResults = {"TREATMENT_PLACE_1030000":{"serviceType":"treatmentResults","notAfter":1770260854347,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:37","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120737_1908","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"SIGNIFICANT - Pain resolved, breathing easier","protocol_id":"GENERAL_TREATMENT_01","overall_response":"EXCELLENT - Treatment goals being met","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","discharge_ready":"true","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257244256,"placeId":"TREATMENT_PLACE_1030000","service_start_time":1770257256182,"version":"v001","sequenceId":"1030000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":1120,"original_token":"{\"notAfter\":1770257364256,\"tokenId\":\"1030000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1030000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257244256,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257257302,"status":"TREATMENT_COMPLETE"}}
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - TIMING: EventReactor arrival time not found, using ServiceThread dequeue time=1770257254814 for seqID=1030001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770257244256 for seqID=1030001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Sequence ID: 1030001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service: TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770257254814
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Invocation Time: 1770257255983
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Publish Time: 1770257257865
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770257244256
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 1030001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 1169ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service Time: 1882ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Total Time: 3051ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 1030000
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service TreatmentService sequence ID: 1030000 complete.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: diagnosisResults = {"DIAGNOSIS_PLACE_1040001":{"serviceType":"diagnosisResults","notAfter":1770260858711,"tokenId":"token_default","data":{"differential_diagnoses":["Differential diagnosis based on clinical presentation"],"primary_diagnosis":"Clinical assessment based on available findings","disposition":"OUTPATIENT_FOLLOWUP","confidence_level":"LOW","physician":"DR_EM_EMERGENCY","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","protocol_id":"GENERAL_DIAGNOSIS"},"workflow_start_time":1770257247644,"placeId":"DIAGNOSIS_PLACE_1040001","service_start_time":1770257258333,"version":"v001","sequenceId":"1040001","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":380,"original_token":"{\"notAfter\":1770257367644,\"tokenId\":\"1040000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1040000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257247644,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257258713,"status":"DIAGNOSIS_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770257247644 for seqID=1040001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 1040001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - FILTER: Event for TreatmentService.executeTreatmentPlan accepted by TreatmentService thread
WARN ServiceThread-TreatmentService-12106 org.btsn.json.jsonLibrary - Key "diagnosisResults" already exists. Skipping.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=diagnosisResults to join 1040000 (tokenId=1040001, mapSize=1)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Treatment/RuleFolder.v001/executeTreatmentPlan/Service.ruleml
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1040001 buffered at T_in_TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1040001 eventType=BUFFERED
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1040001  -> TreatmentService [BUFFERED] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1040001 BUFFERED at TreatmentService (T_in arrival)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1040001 entering place: TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1040001 eventType=ENTER
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1040001  -> TreatmentService [ENTER] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1040001 ENTER at TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service TreatmentService:executeTreatmentPlan executing with trigger token (no workflow data required)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling TreatmentService.executeTreatmentPlan immediately
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking TreatmentService.executeTreatmentPlan via ServiceHelper (canonical binding)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SequenceID: 1040000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 1195
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Unwrapped place response from key: DIAGNOSIS_PLACE_1040001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Found existing original_token to preserve
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770257247644
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 1195 (removed 0 bytes of metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.TreatmentService.executeTreatmentPlan with 1 CLEAN business data arguments
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.TreatmentService
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Calling executeTreatmentPlan with 1 arguments
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.TreatmentService.executeTreatmentPlan completed in 242ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Using wrapped response key 'TREATMENT_PLACE_1040000' instead of 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"TREATMENT_PLACE_1040000":{"serviceType":"treatmentResults","notAfter":1770260858711,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:40","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120740_4205","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"SIGNIFICANT - Pain resolved, breathing easier","protocol_id":"GENERAL_TREATMENT_01","overall_response":"EXCELLENT - Treatment goals being met","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","discharge_ready":"true","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257247644,"placeId":"TREATMENT_PLACE_1040000","service_start_time":1770257260248,"version":"v001","sequenceId":"1040000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":242,"original_token":"{\"notAfter\":1770257367644,\"tokenId\":\"1040000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1040000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257247644,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257260490,"status":"TREATMENT_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1040001 exiting place: TreatmentService -> MonitorService [arc=$ANON11]
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_TreatmentService token=1040001 eventType=EXIT
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_TreatmentService (EdgeNode) token=1040001 TreatmentService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1040001 EXIT from TreatmentService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: Token 1040001 -> 'treatmentResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute treatmentResults = {"TREATMENT_PLACE_1040000":{"serviceType":"treatmentResults","notAfter":1770260858711,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:40","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120740_4205","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"SIGNIFICANT - Pain resolved, breathing easier","protocol_id":"GENERAL_TREATMENT_01","overall_response":"EXCELLENT - Treatment goals being met","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","discharge_ready":"true","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257247644,"placeId":"TREATMENT_PLACE_1040000","service_start_time":1770257260248,"version":"v001","sequenceId":"1040000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":242,"original_token":"{\"notAfter\":1770257367644,\"tokenId\":\"1040000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1040000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257247644,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257260490,"status":"TREATMENT_COMPLETE"}}
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - TIMING: EventReactor arrival time not found, using ServiceThread dequeue time=1770257259274 for seqID=1040001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770257247644 for seqID=1040001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Sequence ID: 1040001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service: TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770257259274
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Invocation Time: 1770257260085
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Publish Time: 1770257260791
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770257247644
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 1040001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 811ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service Time: 706ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Total Time: 1517ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 1040000
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service TreatmentService sequence ID: 1040000 complete.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: diagnosisResults = {"DIAGNOSIS_PLACE_1050001":{"serviceType":"diagnosisResults","notAfter":1770260862216,"tokenId":"token_default","data":{"differential_diagnoses":["Differential diagnosis based on clinical presentation"],"primary_diagnosis":"Clinical assessment based on available findings","disposition":"OUTPATIENT_FOLLOWUP","confidence_level":"LOW","physician":"DR_EM_EMERGENCY","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","protocol_id":"GENERAL_DIAGNOSIS"},"workflow_start_time":1770257248842,"placeId":"DIAGNOSIS_PLACE_1050001","service_start_time":1770257261479,"version":"v001","sequenceId":"1050001","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":742,"original_token":"{\"notAfter\":1770257368842,\"tokenId\":\"1050000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1050000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257248842,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257262221,"status":"DIAGNOSIS_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770257248849 for seqID=1050001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 1050001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - FILTER: Event for TreatmentService.executeTreatmentPlan accepted by TreatmentService thread
WARN ServiceThread-TreatmentService-12106 org.btsn.json.jsonLibrary - Key "diagnosisResults" already exists. Skipping.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=diagnosisResults to join 1050000 (tokenId=1050001, mapSize=1)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Treatment/RuleFolder.v001/executeTreatmentPlan/Service.ruleml
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1050001 buffered at T_in_TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1050001 eventType=BUFFERED
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1050001  -> TreatmentService [BUFFERED] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1050001 BUFFERED at TreatmentService (T_in arrival)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1050001 entering place: TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1050001 eventType=ENTER
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1050001  -> TreatmentService [ENTER] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1050001 ENTER at TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service TreatmentService:executeTreatmentPlan executing with trigger token (no workflow data required)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling TreatmentService.executeTreatmentPlan immediately
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking TreatmentService.executeTreatmentPlan via ServiceHelper (canonical binding)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SequenceID: 1050000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 1195
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Unwrapped place response from key: DIAGNOSIS_PLACE_1050001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Found existing original_token to preserve
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770257248842
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 1195 (removed 0 bytes of metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.TreatmentService.executeTreatmentPlan with 1 CLEAN business data arguments
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.TreatmentService
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Calling executeTreatmentPlan with 1 arguments
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.TreatmentService.executeTreatmentPlan completed in 832ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Using wrapped response key 'TREATMENT_PLACE_1050000' instead of 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"TREATMENT_PLACE_1050000":{"serviceType":"treatmentResults","notAfter":1770260862216,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:45","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120745_5759","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"MODERATE - Partial symptom relief","protocol_id":"GENERAL_TREATMENT_01","overall_response":"GOOD - Continued monitoring needed","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","adverse_events":["Minor bleeding at IV site"],"discharge_ready":"false","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257248842,"placeId":"TREATMENT_PLACE_1050000","service_start_time":1770257264185,"version":"v001","sequenceId":"1050000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":832,"original_token":"{\"notAfter\":1770257368842,\"tokenId\":\"1050000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1050000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257248842,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257265017,"status":"TREATMENT_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1050001 exiting place: TreatmentService -> MonitorService [arc=$ANON11]
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_TreatmentService token=1050001 eventType=EXIT
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_TreatmentService (EdgeNode) token=1050001 TreatmentService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1050001 EXIT from TreatmentService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: Token 1050001 -> 'treatmentResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute treatmentResults = {"TREATMENT_PLACE_1050000":{"serviceType":"treatmentResults","notAfter":1770260862216,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:45","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120745_5759","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"MODERATE - Partial symptom relief","protocol_id":"GENERAL_TREATMENT_01","overall_response":"GOOD - Continued monitoring needed","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","adverse_events":["Minor bleeding at IV site"],"discharge_ready":"false","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257248842,"placeId":"TREATMENT_PLACE_1050000","service_start_time":1770257264185,"version":"v001","sequenceId":"1050000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":832,"original_token":"{\"notAfter\":1770257368842,\"tokenId\":\"1050000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1050000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257248842,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257265017,"status":"TREATMENT_COMPLETE"}}
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - TIMING: EventReactor arrival time not found, using ServiceThread dequeue time=1770257262541 for seqID=1050001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770257248849 for seqID=1050001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Sequence ID: 1050001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service: TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770257262541
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Invocation Time: 1770257263863
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Publish Time: 1770257265857
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770257248849
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 1050001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 1322ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service Time: 1994ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Total Time: 3316ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 1050000
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service TreatmentService sequence ID: 1050000 complete.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: diagnosisResults = {"DIAGNOSIS_PLACE_1060001":{"serviceType":"diagnosisResults","notAfter":1770260866754,"tokenId":"token_default","data":{"differential_diagnoses":["Differential diagnosis based on clinical presentation"],"primary_diagnosis":"Clinical assessment based on available findings","disposition":"OUTPATIENT_FOLLOWUP","confidence_level":"LOW","physician":"DR_EM_EMERGENCY","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","protocol_id":"GENERAL_DIAGNOSIS"},"workflow_start_time":1770257250628,"placeId":"DIAGNOSIS_PLACE_1060001","service_start_time":1770257265403,"version":"v001","sequenceId":"1060001","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":1357,"original_token":"{\"notAfter\":1770257370628,\"tokenId\":\"1060000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1060000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257250628,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257266760,"status":"DIAGNOSIS_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770257250628 for seqID=1060001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 1060001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - FILTER: Event for TreatmentService.executeTreatmentPlan accepted by TreatmentService thread
WARN ServiceThread-TreatmentService-12106 org.btsn.json.jsonLibrary - Key "diagnosisResults" already exists. Skipping.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=diagnosisResults to join 1060000 (tokenId=1060001, mapSize=1)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Treatment/RuleFolder.v001/executeTreatmentPlan/Service.ruleml
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1060001 buffered at T_in_TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1060001 eventType=BUFFERED
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1060001  -> TreatmentService [BUFFERED] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1060001 BUFFERED at TreatmentService (T_in arrival)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1060001 entering place: TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1060001 eventType=ENTER
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1060001  -> TreatmentService [ENTER] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1060001 ENTER at TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service TreatmentService:executeTreatmentPlan executing with trigger token (no workflow data required)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling TreatmentService.executeTreatmentPlan immediately
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking TreatmentService.executeTreatmentPlan via ServiceHelper (canonical binding)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SequenceID: 1060000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 1196
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Unwrapped place response from key: DIAGNOSIS_PLACE_1060001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Found existing original_token to preserve
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770257250628
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 1196 (removed 0 bytes of metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.TreatmentService.executeTreatmentPlan with 1 CLEAN business data arguments
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.TreatmentService
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Calling executeTreatmentPlan with 1 arguments
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.TreatmentService.executeTreatmentPlan completed in 259ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Using wrapped response key 'TREATMENT_PLACE_1060000' instead of 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"TREATMENT_PLACE_1060000":{"serviceType":"treatmentResults","notAfter":1770260866754,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:48","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120748_5128","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"SIGNIFICANT - Pain resolved, breathing easier","protocol_id":"GENERAL_TREATMENT_01","overall_response":"EXCELLENT - Treatment goals being met","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","adverse_events":["Minor bleeding at IV site"],"discharge_ready":"false","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257250628,"placeId":"TREATMENT_PLACE_1060000","service_start_time":1770257268236,"version":"v001","sequenceId":"1060000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":259,"original_token":"{\"notAfter\":1770257370628,\"tokenId\":\"1060000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1060000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257250628,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257268495,"status":"TREATMENT_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1060001 exiting place: TreatmentService -> MonitorService [arc=$ANON11]
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_TreatmentService token=1060001 eventType=EXIT
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_TreatmentService (EdgeNode) token=1060001 TreatmentService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1060001 EXIT from TreatmentService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: Token 1060001 -> 'treatmentResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute treatmentResults = {"TREATMENT_PLACE_1060000":{"serviceType":"treatmentResults","notAfter":1770260866754,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:48","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120748_5128","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"SIGNIFICANT - Pain resolved, breathing easier","protocol_id":"GENERAL_TREATMENT_01","overall_response":"EXCELLENT - Treatment goals being met","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","adverse_events":["Minor bleeding at IV site"],"discharge_ready":"false","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257250628,"placeId":"TREATMENT_PLACE_1060000","service_start_time":1770257268236,"version":"v001","sequenceId":"1060000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":259,"original_token":"{\"notAfter\":1770257370628,\"tokenId\":\"1060000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1060000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257250628,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257268495,"status":"TREATMENT_COMPLETE"}}
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - TIMING: EventReactor arrival time not found, using ServiceThread dequeue time=1770257267266 for seqID=1060001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770257250628 for seqID=1060001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Sequence ID: 1060001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service: TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770257267266
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Invocation Time: 1770257268054
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Publish Time: 1770257269108
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770257250628
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 1060001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 788ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service Time: 1054ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Total Time: 1842ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 1060000
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service TreatmentService sequence ID: 1060000 complete.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: diagnosisResults = {"DIAGNOSIS_PLACE_1070001":{"serviceType":"diagnosisResults","notAfter":1770260870476,"tokenId":"token_default","data":{"differential_diagnoses":["Differential diagnosis based on clinical presentation"],"primary_diagnosis":"Clinical assessment based on available findings","disposition":"OUTPATIENT_FOLLOWUP","confidence_level":"LOW","physician":"DR_EM_EMERGENCY","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","protocol_id":"GENERAL_DIAGNOSIS"},"workflow_start_time":1770257252251,"placeId":"DIAGNOSIS_PLACE_1070001","service_start_time":1770257270256,"version":"v001","sequenceId":"1070001","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":224,"original_token":"{\"notAfter\":1770257372251,\"tokenId\":\"1070000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1070000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257252251,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257270480,"status":"DIAGNOSIS_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770257252251 for seqID=1070001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 1070001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - FILTER: Event for TreatmentService.executeTreatmentPlan accepted by TreatmentService thread
WARN ServiceThread-TreatmentService-12106 org.btsn.json.jsonLibrary - Key "diagnosisResults" already exists. Skipping.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=diagnosisResults to join 1070000 (tokenId=1070001, mapSize=1)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Treatment/RuleFolder.v001/executeTreatmentPlan/Service.ruleml
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1070001 buffered at T_in_TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1070001 eventType=BUFFERED
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1070001  -> TreatmentService [BUFFERED] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1070001 BUFFERED at TreatmentService (T_in arrival)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1070001 entering place: TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1070001 eventType=ENTER
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1070001  -> TreatmentService [ENTER] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1070001 ENTER at TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service TreatmentService:executeTreatmentPlan executing with trigger token (no workflow data required)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling TreatmentService.executeTreatmentPlan immediately
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking TreatmentService.executeTreatmentPlan via ServiceHelper (canonical binding)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.TreatmentService.executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SequenceID: 1070000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 1195
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Unwrapped place response from key: DIAGNOSIS_PLACE_1070001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Found existing original_token to preserve
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770257252251
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 1195 (removed 0 bytes of metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.TreatmentService.executeTreatmentPlan with 1 CLEAN business data arguments
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.TreatmentService.executeTreatmentPlan
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.TreatmentService
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - INVOKE: Calling executeTreatmentPlan with 1 arguments
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.TreatmentService.executeTreatmentPlan completed in 873ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Using wrapped response key 'TREATMENT_PLACE_1070000' instead of 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"TREATMENT_PLACE_1070000":{"serviceType":"treatmentResults","notAfter":1770260870476,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:54","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120754_1067","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"MODERATE - Partial symptom relief","protocol_id":"GENERAL_TREATMENT_01","overall_response":"GOOD - Continued monitoring needed","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","discharge_ready":"false","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257252251,"placeId":"TREATMENT_PLACE_1070000","service_start_time":1770257273723,"version":"v001","sequenceId":"1070000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":873,"original_token":"{\"notAfter\":1770257372251,\"tokenId\":\"1070000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1070000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257252251,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257274596,"status":"TREATMENT_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1070001 exiting place: TreatmentService -> MonitorService [arc=$ANON11]
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_TreatmentService token=1070001 eventType=EXIT
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_TreatmentService (EdgeNode) token=1070001 TreatmentService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1070001 EXIT from TreatmentService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'treatmentResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ROUTING: Token 1070001 -> 'treatmentResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute treatmentResults = {"TREATMENT_PLACE_1070000":{"serviceType":"treatmentResults","notAfter":1770260870476,"tokenId":"token_default","data":{"completion_time":"2026-02-05 12:07:54","confidence_level":"LOW","diagnosis_treated":"Unknown diagnosis","treatment_id":"TREAT_unknown_20260205120754_1067","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","symptom_improvement":"MODERATE - Partial symptom relief","protocol_id":"GENERAL_TREATMENT_01","overall_response":"GOOD - Continued monitoring needed","differential_diagnoses":"[\"Differential diagnosis based on clinical presentation\"]","primary_diagnosis":"Clinical assessment based on available findings","disposition":"OBSERVATION","discharge_ready":"false","nurse":"RN_TREATMENT","physician":"DR_EM_EMERGENCY","treatment_goals_met":"true"},"workflow_start_time":1770257252251,"placeId":"TREATMENT_PLACE_1070000","service_start_time":1770257273723,"version":"v001","sequenceId":"1070000","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":873,"original_token":"{\"notAfter\":1770257372251,\"tokenId\":\"1070000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1070000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257252251,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257274596,"status":"TREATMENT_COMPLETE"}}
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - TIMING: EventReactor arrival time not found, using ServiceThread dequeue time=1770257271743 for seqID=1070001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770257252251 for seqID=1070001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Sequence ID: 1070001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service: TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770257271743
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Invocation Time: 1770257273244
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Publish Time: 1770257275036
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770257252251
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 1070001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 1501ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Service Time: 1792ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Total Time: 3293ms
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 1070000
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service TreatmentService sequence ID: 1070000 complete.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: diagnosisResults = {"DIAGNOSIS_PLACE_1080001":{"serviceType":"diagnosisResults","notAfter":1770260874972,"tokenId":"token_default","data":{"differential_diagnoses":["Differential diagnosis based on clinical presentation"],"primary_diagnosis":"Clinical assessment based on available findings","disposition":"OUTPATIENT_FOLLOWUP","confidence_level":"LOW","physician":"DR_EM_EMERGENCY","clinical_reasoning":"Clinical synthesis: Patient presents with unspecified. Primary diagnosis: Clinical assessment based on available findings. Severity assessed as MILD.","protocol_id":"GENERAL_DIAGNOSIS"},"workflow_start_time":1770257254038,"placeId":"DIAGNOSIS_PLACE_1080001","service_start_time":1770257274827,"version":"v001","sequenceId":"1080001","executionTime":0,"marking":0,"currentPlace":"P1","service_processing_time_ms":146,"original_token":"{\"notAfter\":1770257374038,\"tokenId\":\"1080000\",\"data\":{\"condition\":\"chest pain\",\"patientId\":\"P_Triage_1080000\",\"providerId\":\"RN_TRIAGE_001\",\"priority\":\"STANDARD\",\"department\":\"EMERGENCY\"},\"workflow_start_time\":1770257254038,\"currentPlace\":\"TriageService\",\"version\":\"v001\"}","service_end_time":1770257274973,"status":"DIAGNOSIS_COMPLETE"}}
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770257254038 for seqID=1080001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 1080001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v001
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - FILTER: Event for TreatmentService.executeTreatmentPlan accepted by TreatmentService thread
WARN ServiceThread-TreatmentService-12106 org.btsn.json.jsonLibrary - Key "diagnosisResults" already exists. Skipping.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=diagnosisResults to join 1080000 (tokenId=1080001, mapSize=1)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: executeTreatmentPlan
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Treatment/RuleFolder.v001/executeTreatmentPlan/Service.ruleml
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v001
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for TreatmentService.executeTreatmentPlan with attribute 'diagnosisResults'
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation executeTreatmentPlan uses standard (AND) semantics
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan requires 1 inputs total (standard AND logic)
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: executeTreatmentPlan needs 1 input - can call immediately with 'diagnosisResults'
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1080001 buffered at T_in_TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1080001 eventType=BUFFERED
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1080001  -> TreatmentService [BUFFERED] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1080001 BUFFERED at TreatmentService (T_in arrival)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Token 1080001 entering place: TreatmentService (buffer=0)
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'TreatmentService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-TreatmentService-12106 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_TreatmentService token=1080001 eventType=ENTER
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_TreatmentService (EdgeNode) token=1080001  -> TreatmentService [ENTER] buffer=0
DEBUG ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - PETRI-NET: Token 1080001 ENTER at TreatmentService
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-TreatmentService-12106 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service TreatmentService:executeTreatmentPlan executing with trigger token (no workflow data required)
