{
  "metadata": {
    "name": "Traffic Light Intersection - Fork/Join Model",
    "version": "2.4",
    "author": "BTSN Petri Net Designer",
    "created": "2025-12-26",
    "type": "Fork/Join Petri Net"
  },
   "processType":"PetriNet",
  "documentation": {
    "title": "Traffic Light Intersection - Fork/Join Control",
    "summary": "Models a 4-way intersection using Fork/Join constructs. When NS goes through its Green-Yellow-Red cycle, a parallel path keeps EW in Red state. Then they swap - EW cycles while NS stays Red. Fork splits the control, Join synchronizes before swap.",
    "topology": {
      "description": "Fork/Join pattern with parallel holding paths",
      "pattern": "FORK splits to active cycle + holding path, JOIN synchronizes before swap"
    },
    "tokens": [
      {
        "id": "v001",
        "name": "Controller A",
        "color": "blue",
        "sequenceBase": 1000000,
        "description": "First traffic controller - higher priority"
      },
      {
        "id": "v002",
        "name": "Controller B",
        "color": "red",
        "sequenceBase": 2000000,
        "description": "Second traffic controller - lower priority"
      }
    ],
    "places": [
      {"id": "P1", "service": "P1_Place", "label": "NS_Green", "description": "NS light is GREEN"},
      {"id": "P2", "service": "P2_Place", "label": "NS_Yellow", "description": "NS light is YELLOW"},
      {"id": "P3", "service": "P3_Place", "label": "EW_Red_Hold", "description": "EW stays RED while NS cycles"},
      {"id": "P4", "service": "P4_Place", "label": "EW_Green", "description": "EW light is GREEN"},
      {"id": "P5", "service": "P5_Place", "label": "EW_Yellow", "description": "EW light is YELLOW"},
      {"id": "P6", "service": "P6_Place", "label": "NS_Red_Hold", "description": "NS stays RED while EW cycles"}
    ],
    "transitions": {
      "forks": ["T_out_NS_Green (GatewayNode) - splits to NS_Yellow and EW_Red_Hold", "T_out_EW_Green (GatewayNode) - splits to EW_Yellow and NS_Red_Hold"],
      "joins": ["T_in_EW_Green (JoinNode) - waits for NS cycle complete + EW_Red_Hold", "T_in_NS_Green (JoinNode) - waits for EW cycle complete + NS_Red_Hold"]
    }
  },
  "elements": [
    {
      "id": "TRAFFICLIGHT_EVENTGENERATOR",
      "type": "EVENT_GENERATOR",
      "x": 30,
      "y": 270,
      "width": 24,
      "height": 60,
      "label": "TRAFFICLIGHT_EVENTGENERATOR",
      "rotation": 0.0,
      "generator_rate": "1000",
      "token_version": "v001"
    },
    {
      "id": "T_in_NS_Green",
      "type": "TRANSITION",
      "x": 148,
      "y": 270,
      "width": 24,
      "height": 60,
      "label": "T_in_NS_Green",
      "rotation": 0.0,
      "node_type": "JoinNode",
      "node_value": "JOIN_NODE",
      "transition_type": "T_in",
      "buffer": "10"
    },
    {
      "id": "NS_Green",
      "type": "PLACE",
      "x": 215,
      "y": 275,
      "width": 50,
      "height": 50,
      "label": "NS_Green",
      "service": "P1_Place",
      "operations": [
        {
          "name": "processToken",
          "arguments": [
            {"name": "token_branch1", "type": "String", "value": "String", "required": false},
            {"name": "token_branch2", "type": "String", "value": "String", "required": false}
          ]
        }
      ]
    },
    {
      "id": "T_out_NS_Green",
      "type": "TRANSITION",
      "x": 308,
      "y": 270,
      "width": 24,
      "height": 60,
      "label": "T_out_NS_Green",
      "rotation": 0.0,
      "node_type": "ForkNode",
      "node_value": "FORK_NODE",
      "transition_type": "T_out"
    },
    {
      "id": "T_in_NS_Yellow",
      "type": "TRANSITION",
      "x": 388,
      "y": 270,
      "width": 24,
      "height": 60,
      "label": "T_in_NS_Yellow",
      "rotation": 0.0,
      "node_type": "EdgeNode",
      "node_value": "EDGE_NODE",
      "transition_type": "T_in",
      "buffer": "10"
    },
    {
      "id": "NS_Yellow",
      "type": "PLACE",
      "x": 475,
      "y": 275,
      "width": 50,
      "height": 50,
      "label": "NS_Yellow",
      "service": "P2_Place",
      "operations": [
        {
          "name": "processToken",
          "arguments": [
            {"name": "token", "type": "String", "value": "String", "required": false}
          ]
        }
      ]
    },
    {
      "id": "T_out_NS_Yellow",
      "type": "TRANSITION",
      "x": 568,
      "y": 270,
      "width": 24,
      "height": 60,
      "label": "T_out_NS_Yellow",
      "rotation": 0.0,
      "node_type": "XorNode",
      "node_value": "XOR_NODE",
      "transition_type": "T_out"
    },
    {
      "id": "T_in_EW_Red_Hold",
      "type": "TRANSITION",
      "x": 388,
      "y": 410,
      "width": 24,
      "height": 60,
      "label": "T_in_EW_Red_Hold",
      "rotation": 0.0,
      "node_type": "EdgeNode",
      "node_value": "EDGE_NODE",
      "transition_type": "T_in",
      "buffer": "10"
    },
    {
      "id": "EW_Red_Hold",
      "type": "PLACE",
      "x": 475,
      "y": 415,
      "width": 50,
      "height": 50,
      "label": "EW_Red_Hold",
      "service": "P3_Place",
      "operations": [
        {
          "name": "processToken",
          "arguments": [
            {"name": "token", "type": "String", "value": "String", "required": false}
          ]
        }
      ]
    },
    {
      "id": "T_out_EW_Red_Hold",
      "type": "TRANSITION",
      "x": 568,
      "y": 410,
      "width": 24,
      "height": 60,
      "label": "T_out_EW_Red_Hold",
      "rotation": 0.0,
      "node_type": "XorNode",
      "node_value": "XOR_NODE",
      "transition_type": "T_out"
    },
    {
      "id": "T_in_EW_Green",
      "type": "TRANSITION",
      "x": 670,
      "y": 330,
      "width": 24,
      "height": 60,
      "label": "T_in_EW_Green",
      "rotation": 0.0,
      "node_type": "JoinNode",
      "node_value": "JOIN_NODE",
      "transition_type": "T_in",
      "buffer": "10"
    },
    {
      "id": "EW_Green",
      "type": "PLACE",
      "x": 735,
      "y": 335,
      "width": 50,
      "height": 50,
      "label": "EW_Green",
      "service": "P4_Place",
      "operations": [
        {
          "name": "processToken",
          "arguments": [
            {"name": "token_branch1", "type": "String", "value": "String", "required": false},
            {"name": "token_branch2", "type": "String", "value": "String", "required": false}
          ]
        }
      ]
    },
    {
      "id": "T_out_EW_Green",
      "type": "TRANSITION",
      "x": 830,
      "y": 330,
      "width": 24,
      "height": 60,
      "label": "T_out_EW_Green",
      "rotation": 0.0,
      "node_type": "ForkNode",
      "node_value": "FORK_NODE",
      "transition_type": "T_out"
    },
    {
      "id": "T_in_EW_Yellow",
      "type": "TRANSITION",
      "x": 930,
      "y": 410,
      "width": 24,
      "height": 60,
      "label": "T_in_EW_Yellow",
      "rotation": 0.0,
      "node_type": "EdgeNode",
      "node_value": "EDGE_NODE",
      "transition_type": "T_in",
      "buffer": "10"
    },
    {
      "id": "EW_Yellow",
      "type": "PLACE",
      "x": 995,
      "y": 415,
      "width": 50,
      "height": 50,
      "label": "EW_Yellow",
      "service": "P5_Place",
      "operations": [
        {
          "name": "processToken",
          "arguments": [
            {"name": "token", "type": "String", "value": "String", "required": false}
          ]
        }
      ]
    },
    {
      "id": "T_out_EW_Yellow",
      "type": "TRANSITION",
      "x": 1088,
      "y": 410,
      "width": 24,
      "height": 60,
      "label": "T_out_EW_Yellow",
      "rotation": 0.0,
      "node_type": "XorNode",
      "node_value": "XOR_NODE",
      "transition_type": "T_out"
    },
    {
      "id": "T_in_NS_Red_Hold",
      "type": "TRANSITION",
      "x": 928,
      "y": 250,
      "width": 24,
      "height": 60,
      "label": "T_in_NS_Red_Hold",
      "rotation": 0.0,
      "node_type": "EdgeNode",
      "node_value": "EDGE_NODE",
      "transition_type": "T_in",
      "buffer": "10"
    },
    {
      "id": "NS_Red_Hold",
      "type": "PLACE",
      "x": 995,
      "y": 255,
      "width": 50,
      "height": 50,
      "label": "NS_Red_Hold",
      "service": "P6_Place",
      "operations": [
        {
          "name": "processToken",
          "arguments": [
            {"name": "token", "type": "String", "value": "String", "required": false}
          ]
        }
      ]
    },
    {
      "id": "T_out_NS_Red_Hold",
      "type": "TRANSITION",
      "x": 1088,
      "y": 250,
      "width": 24,
      "height": 60,
      "label": "T_out_NS_Red_Hold",
      "rotation": 0.0,
      "node_type": "XorNode",
      "node_value": "XOR_NODE",
      "transition_type": "T_out"
    }
  ],
  "arrows": [
    {
      "source": "TRAFFICLIGHT_EVENTGENERATOR",
      "target": "T_in_NS_Green",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_in_NS_Green",
      "target": "NS_Green",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "NS_Green",
      "target": "T_out_NS_Green",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_in_NS_Yellow",
      "target": "NS_Yellow",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "NS_Yellow",
      "target": "T_out_NS_Yellow",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_out_NS_Yellow",
      "target": "T_in_EW_Green",
      "label": "true",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "true",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 620, "y": 300},
        {"x": 620, "y": 360}
      ]
    },
    {
      "source": "T_in_EW_Red_Hold",
      "target": "EW_Red_Hold",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "EW_Red_Hold",
      "target": "T_out_EW_Red_Hold",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_out_EW_Red_Hold",
      "target": "T_in_EW_Green",
      "label": "true",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "true",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 620, "y": 440},
        {"x": 620, "y": 360}
      ]
    },
    {
      "source": "T_in_EW_Green",
      "target": "EW_Green",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "EW_Green",
      "target": "T_out_EW_Green",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_out_EW_Green",
      "target": "T_in_EW_Yellow",
      "label": "EW path",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "true",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 880, "y": 360},
        {"x": 880, "y": 440}
      ],
      "labelOffsetX": -24,
      "labelOffsetY": 27
    },
    {
      "source": "T_out_EW_Green",
      "target": "T_in_NS_Red_Hold",
      "label": "NS hold",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "true",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 880, "y": 360},
        {"x": 880, "y": 280}
      ],
      "labelOffsetX": -16,
      "labelOffsetY": -36
    },
    {
      "source": "T_in_EW_Yellow",
      "target": "EW_Yellow",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "EW_Yellow",
      "target": "T_out_EW_Yellow",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_in_NS_Red_Hold",
      "target": "NS_Red_Hold",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "NS_Red_Hold",
      "target": "T_out_NS_Red_Hold",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_out_EW_Yellow",
      "target": "T_in_NS_Green",
      "label": "true",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "true",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 1140, "y": 440},
        {"x": 1140, "y": 540},
        {"x": 100, "y": 540},
        {"x": 100, "y": 300}
      ],
      "labelOffsetX": 18,
      "labelOffsetY": -25
    },
    {
      "source": "T_out_NS_Red_Hold",
      "target": "T_in_NS_Green",
      "label": "true",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "true",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 1140, "y": 280},
        {"x": 1140, "y": 200},
        {"x": 100, "y": 200},
        {"x": 100, "y": 300}
      ],
      "labelOffsetX": 9,
      "labelOffsetY": 15
    },
    {
      "source": "T_out_NS_Yellow",
      "target": "T_in_NS_Yellow",
      "label": "retry",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "false",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 580, "y": 220},
        {"x": 400, "y": 220}
      ],
      "labelOffsetX": -38,
      "labelOffsetY": 7
    },
    {
      "source": "T_out_EW_Red_Hold",
      "target": "T_in_EW_Red_Hold",
      "label": "retry",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "false",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 580, "y": 520},
        {"x": 400, "y": 520}
      ],
      "labelOffsetX": -47,
      "labelOffsetY": -2
    },
    {
      "source": "T_out_EW_Yellow",
      "target": "T_in_EW_Yellow",
      "label": "retry",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "false",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 1100, "y": 520},
        {"x": 940, "y": 520}
      ],
      "labelOffsetX": -64,
      "labelOffsetY": -4
    },
    {
      "source": "T_out_NS_Red_Hold",
      "target": "T_in_NS_Red_Hold",
      "label": "retry",
      "guardCondition": "DECISION_EQUAL_TO",
      "decision_value": "false",
      "endpoint": "processToken",
      "waypoints": [
        {"x": 1100, "y": 220},
        {"x": 940, "y": 220}
      ],
      "labelOffsetX": -31,
      "labelOffsetY": -5
    },
    {
      "source": "T_out_NS_Green",
      "target": "T_in_NS_Yellow",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": ""
    },
    {
      "source": "T_out_NS_Green",
      "target": "T_in_EW_Red_Hold",
      "label": "",
      "guardCondition": "",
      "decision_value": "",
      "endpoint": "",
      "waypoints": [
        {"x": 320, "y": 440}
      ]
    }
  ],
  "textElements": [
    {
      "x": 413,
      "y": 166,
      "text": "Traffic Light Intersection - Fork/Join/Feedback  Model",
      "fontSize": 14,
      "fontStyle": 1,
      "color": -16777216
    },
    {
      "x": 211,
      "y": 256,
      "text": "NS GREEN",
      "fontSize": 10,
      "fontStyle": 1,
      "color": -16744448
    },
    {
      "x": 470,
      "y": 262,
      "text": "NS YELLOW",
      "fontSize": 10,
      "fontStyle": 1,
      "color": -26368
    },
    {
      "x": 467,
      "y": 408,
      "text": "EW RED (hold)",
      "fontSize": 10,
      "fontStyle": 0,
      "color": -65536
    },
    {
      "x": 736,
      "y": 299,
      "text": "EW GREEN",
      "fontSize": 10,
      "fontStyle": 1,
      "color": -16744448
    },
    {
      "x": 988,
      "y": 398,
      "text": "EW YELLOW",
      "fontSize": 10,
      "fontStyle": 1,
      "color": -26368
    },
    {
      "x": 990,
      "y": 240,
      "text": "NS RED (hold)",
      "fontSize": 10,
      "fontStyle": 0,
      "color": -65536
    },
    {
      "x": 309,
      "y": 261,
      "text": "FORK",
      "fontSize": 9,
      "fontStyle": 1,
      "color": -16777216
    },
    {
      "x": 672,
      "y": 320,
      "text": "JOIN",
      "fontSize": 9,
      "fontStyle": 1,
      "color": -16777216
    },
    {
      "x": 844,
      "y": 311,
      "text": "FORK",
      "fontSize": 9,
      "fontStyle": 1,
      "color": -16777216
    },
    {
      "x": 148,
      "y": 256,
      "text": "JOIN",
      "fontSize": 9,
      "fontStyle": 1,
      "color": -16777216
    },
    {
      "x": 600,
      "y": 289,
      "text": "XOR Node",
      "fontSize": 12,
      "fontStyle": 0,
      "color": -16777216
    },
    {
      "x": 603,
      "y": 461,
      "text": "XOR Node",
      "fontSize": 12,
      "fontStyle": 0,
      "color": -16777216
    },
    {
      "x": 1122,
      "y": 303,
      "text": "XOR Node",
      "fontSize": 12,
      "fontStyle": 0,
      "color": -16777216
    },
    {
      "x": 1116,
      "y": 429,
      "text": "XOR Node",
      "fontSize": 12,
      "fontStyle": 0,
      "color": -16777216
    },
    {
      "x": 655,
      "y": 239,
      "text": "Service Nodes return True or | False with equal probability",
      "fontSize": 12,
      "fontStyle": 0,
      "color": -16777216
    }
  ]
}
