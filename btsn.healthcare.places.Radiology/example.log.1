INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: Token 2030000 -> 'radiologyResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute radiologyResults = {"RAD_PLACE_2030000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338871905,"marking":0,"tokenId":"2030000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104552_6835","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338751905,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2030000","version":"v002","sequenceId":"2030000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2030000_2416","external_hospital":"EXTERNAL_HOSPITAL_414","federated_timestamp":1770338752416,"cross_facility_audit":true,"result_routing":"return_to_origin"}
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - TIMING: Using EventReactor arrival time=1770338751948 for seqID=2030000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770338751906 for seqID=2030000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Sequence ID: 2030000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service: RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770338751948
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Invocation Time: 1770338752194
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Publish Time: 1770338752569
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770338751906
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 2030000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 246ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service Time: 375ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Total Time: 621ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 2030000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service RadiologyService sequence ID: 2030000 complete.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: token = {"notAfter":1770338875306,"tokenId":"2040000","data":{},"workflow_start_time":1770338755306,"currentPlace":"RadiologyService","version":"v002"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770338755307 for seqID=2040000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 2040000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v002
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - FILTER: Event for RadiologyService.federatedRadiologyRequest accepted by RadiologyService thread
WARN ServiceThread-RadiologyService-12102 org.btsn.json.jsonLibrary - Key "token" already exists. Skipping.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=token to join 2040000 (tokenId=2040000, mapSize=1)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Radiology/RuleFolder.v002/federatedRadiologyRequest/Service.ruleml
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v002
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2040000 buffered at T_in_RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - GENERATED: Token 2040000 from FEDERATED_RADIOLOGY_REQUEST at 1770338755307 -> RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: FEDERATED_RADIOLOGY_REQUEST token=2040000 eventType=GENERATED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2040000 eventType=BUFFERED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2040000  -> RadiologyService [BUFFERED] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2040000 BUFFERED at RadiologyService (T_in arrival)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2040000 entering place: RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2040000 eventType=ENTER
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2040000  -> RadiologyService [ENTER] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2040000 ENTER at RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service RadiologyService:federatedRadiologyRequest executing with trigger token (no workflow data required)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling RadiologyService.federatedRadiologyRequest immediately
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking RadiologyService.federatedRadiologyRequest via ServiceHelper (canonical binding)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SequenceID: 2040000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 143
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: First service - raw token IS original_token
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770338755306
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 143 (removed 0 bytes of metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.RadiologyService.federatedRadiologyRequest with 1 CLEAN business data arguments
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Calling federatedRadiologyRequest with 1 arguments
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.RadiologyService.federatedRadiologyRequest completed in 138ms
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Output attribute 'radiologyResults' not found in service result, cannot enrich
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"RAD_PLACE_2040000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338875306,"marking":0,"tokenId":"2040000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104555_4878","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338755306,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2040000","version":"v002","sequenceId":"2040000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2040000_5793","external_hospital":"EXTERNAL_HOSPITAL_792","federated_timestamp":1770338755793,"cross_facility_audit":true,"result_routing":"return_to_origin"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2040000 exiting place: RadiologyService -> MonitorService [arc=$ANON11]
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_RadiologyService token=2040000 eventType=EXIT
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_RadiologyService (EdgeNode) token=2040000 RadiologyService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2040000 EXIT from RadiologyService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'radiologyResults'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: Token 2040000 -> 'radiologyResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute radiologyResults = {"RAD_PLACE_2040000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338875306,"marking":0,"tokenId":"2040000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104555_4878","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338755306,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2040000","version":"v002","sequenceId":"2040000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2040000_5793","external_hospital":"EXTERNAL_HOSPITAL_792","federated_timestamp":1770338755793,"cross_facility_audit":true,"result_routing":"return_to_origin"}
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - TIMING: Using EventReactor arrival time=1770338755336 for seqID=2040000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770338755307 for seqID=2040000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Sequence ID: 2040000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service: RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770338755336
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Invocation Time: 1770338755598
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Publish Time: 1770338755875
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770338755307
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 2040000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 262ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service Time: 277ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Total Time: 539ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 2040000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service RadiologyService sequence ID: 2040000 complete.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: token = {"notAfter":1770338877107,"tokenId":"2050000","data":{},"workflow_start_time":1770338757107,"currentPlace":"RadiologyService","version":"v002"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770338757108 for seqID=2050000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 2050000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v002
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - FILTER: Event for RadiologyService.federatedRadiologyRequest accepted by RadiologyService thread
WARN ServiceThread-RadiologyService-12102 org.btsn.json.jsonLibrary - Key "token" already exists. Skipping.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=token to join 2050000 (tokenId=2050000, mapSize=1)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Radiology/RuleFolder.v002/federatedRadiologyRequest/Service.ruleml
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v002
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2050000 buffered at T_in_RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - GENERATED: Token 2050000 from FEDERATED_RADIOLOGY_REQUEST at 1770338757108 -> RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: FEDERATED_RADIOLOGY_REQUEST token=2050000 eventType=GENERATED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2050000 eventType=BUFFERED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2050000  -> RadiologyService [BUFFERED] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2050000 BUFFERED at RadiologyService (T_in arrival)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2050000 entering place: RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2050000 eventType=ENTER
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2050000  -> RadiologyService [ENTER] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2050000 ENTER at RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service RadiologyService:federatedRadiologyRequest executing with trigger token (no workflow data required)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling RadiologyService.federatedRadiologyRequest immediately
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking RadiologyService.federatedRadiologyRequest via ServiceHelper (canonical binding)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SequenceID: 2050000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 143
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: First service - raw token IS original_token
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770338757107
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 143 (removed 0 bytes of metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.RadiologyService.federatedRadiologyRequest with 1 CLEAN business data arguments
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Calling federatedRadiologyRequest with 1 arguments
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.RadiologyService.federatedRadiologyRequest completed in 121ms
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Output attribute 'radiologyResults' not found in service result, cannot enrich
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"RAD_PLACE_2050000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338877107,"marking":0,"tokenId":"2050000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104557_4763","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338757107,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2050000","version":"v002","sequenceId":"2050000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2050000_7576","external_hospital":"EXTERNAL_HOSPITAL_574","federated_timestamp":1770338757576,"cross_facility_audit":true,"result_routing":"return_to_origin"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2050000 exiting place: RadiologyService -> MonitorService [arc=$ANON11]
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_RadiologyService token=2050000 eventType=EXIT
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_RadiologyService (EdgeNode) token=2050000 RadiologyService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2050000 EXIT from RadiologyService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'radiologyResults'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: Token 2050000 -> 'radiologyResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute radiologyResults = {"RAD_PLACE_2050000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338877107,"marking":0,"tokenId":"2050000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104557_4763","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338757107,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2050000","version":"v002","sequenceId":"2050000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2050000_7576","external_hospital":"EXTERNAL_HOSPITAL_574","federated_timestamp":1770338757576,"cross_facility_audit":true,"result_routing":"return_to_origin"}
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - TIMING: Using EventReactor arrival time=1770338757130 for seqID=2050000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770338757108 for seqID=2050000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Sequence ID: 2050000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service: RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770338757130
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Invocation Time: 1770338757396
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Publish Time: 1770338757679
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770338757108
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 2050000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 266ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service Time: 283ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Total Time: 549ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 2050000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service RadiologyService sequence ID: 2050000 complete.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: token = {"notAfter":1770338879907,"tokenId":"2060000","data":{},"workflow_start_time":1770338759907,"currentPlace":"RadiologyService","version":"v002"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770338759907 for seqID=2060000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 2060000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v002
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - FILTER: Event for RadiologyService.federatedRadiologyRequest accepted by RadiologyService thread
WARN ServiceThread-RadiologyService-12102 org.btsn.json.jsonLibrary - Key "token" already exists. Skipping.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=token to join 2060000 (tokenId=2060000, mapSize=1)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Radiology/RuleFolder.v002/federatedRadiologyRequest/Service.ruleml
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v002
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2060000 buffered at T_in_RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - GENERATED: Token 2060000 from FEDERATED_RADIOLOGY_REQUEST at 1770338759907 -> RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: FEDERATED_RADIOLOGY_REQUEST token=2060000 eventType=GENERATED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2060000 eventType=BUFFERED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2060000  -> RadiologyService [BUFFERED] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2060000 BUFFERED at RadiologyService (T_in arrival)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2060000 entering place: RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2060000 eventType=ENTER
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2060000  -> RadiologyService [ENTER] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2060000 ENTER at RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service RadiologyService:federatedRadiologyRequest executing with trigger token (no workflow data required)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling RadiologyService.federatedRadiologyRequest immediately
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking RadiologyService.federatedRadiologyRequest via ServiceHelper (canonical binding)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SequenceID: 2060000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 143
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: First service - raw token IS original_token
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770338759907
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 143 (removed 0 bytes of metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.RadiologyService.federatedRadiologyRequest with 1 CLEAN business data arguments
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Calling federatedRadiologyRequest with 1 arguments
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.RadiologyService.federatedRadiologyRequest completed in 111ms
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Output attribute 'radiologyResults' not found in service result, cannot enrich
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"RAD_PLACE_2060000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338879907,"marking":0,"tokenId":"2060000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104600_2524","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338759907,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2060000","version":"v002","sequenceId":"2060000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2060000_397","external_hospital":"EXTERNAL_HOSPITAL_396","federated_timestamp":1770338760397,"cross_facility_audit":true,"result_routing":"return_to_origin"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2060000 exiting place: RadiologyService -> MonitorService [arc=$ANON11]
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_RadiologyService token=2060000 eventType=EXIT
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_RadiologyService (EdgeNode) token=2060000 RadiologyService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2060000 EXIT from RadiologyService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'radiologyResults'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: Token 2060000 -> 'radiologyResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute radiologyResults = {"RAD_PLACE_2060000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338879907,"marking":0,"tokenId":"2060000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104600_2524","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338759907,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2060000","version":"v002","sequenceId":"2060000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2060000_397","external_hospital":"EXTERNAL_HOSPITAL_396","federated_timestamp":1770338760397,"cross_facility_audit":true,"result_routing":"return_to_origin"}
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - TIMING: Using EventReactor arrival time=1770338759929 for seqID=2060000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770338759907 for seqID=2060000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Sequence ID: 2060000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service: RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770338759929
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Invocation Time: 1770338760212
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Publish Time: 1770338760503
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770338759907
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 2060000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 283ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service Time: 291ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Total Time: 574ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 2060000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service RadiologyService sequence ID: 2060000 complete.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: token = {"notAfter":1770338882705,"tokenId":"2070000","data":{},"workflow_start_time":1770338762705,"currentPlace":"RadiologyService","version":"v002"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770338762706 for seqID=2070000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 2070000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v002
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - FILTER: Event for RadiologyService.federatedRadiologyRequest accepted by RadiologyService thread
WARN ServiceThread-RadiologyService-12102 org.btsn.json.jsonLibrary - Key "token" already exists. Skipping.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=token to join 2070000 (tokenId=2070000, mapSize=1)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Radiology/RuleFolder.v002/federatedRadiologyRequest/Service.ruleml
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v002
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2070000 buffered at T_in_RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - GENERATED: Token 2070000 from FEDERATED_RADIOLOGY_REQUEST at 1770338762706 -> RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: FEDERATED_RADIOLOGY_REQUEST token=2070000 eventType=GENERATED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2070000 eventType=BUFFERED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2070000  -> RadiologyService [BUFFERED] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2070000 BUFFERED at RadiologyService (T_in arrival)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2070000 entering place: RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2070000 eventType=ENTER
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2070000  -> RadiologyService [ENTER] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2070000 ENTER at RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service RadiologyService:federatedRadiologyRequest executing with trigger token (no workflow data required)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling RadiologyService.federatedRadiologyRequest immediately
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking RadiologyService.federatedRadiologyRequest via ServiceHelper (canonical binding)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SequenceID: 2070000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 143
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: First service - raw token IS original_token
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770338762705
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 143 (removed 0 bytes of metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.RadiologyService.federatedRadiologyRequest with 1 CLEAN business data arguments
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Calling federatedRadiologyRequest with 1 arguments
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.RadiologyService.federatedRadiologyRequest completed in 100ms
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Output attribute 'radiologyResults' not found in service result, cannot enrich
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"RAD_PLACE_2070000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338882705,"marking":0,"tokenId":"2070000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104603_2936","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338762705,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2070000","version":"v002","sequenceId":"2070000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2070000_3146","external_hospital":"EXTERNAL_HOSPITAL_143","federated_timestamp":1770338763146,"cross_facility_audit":true,"result_routing":"return_to_origin"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2070000 exiting place: RadiologyService -> MonitorService [arc=$ANON11]
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_RadiologyService token=2070000 eventType=EXIT
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_RadiologyService (EdgeNode) token=2070000 RadiologyService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2070000 EXIT from RadiologyService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'radiologyResults'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: Token 2070000 -> 'radiologyResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute radiologyResults = {"RAD_PLACE_2070000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338882705,"marking":0,"tokenId":"2070000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104603_2936","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338762705,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2070000","version":"v002","sequenceId":"2070000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2070000_3146","external_hospital":"EXTERNAL_HOSPITAL_143","federated_timestamp":1770338763146,"cross_facility_audit":true,"result_routing":"return_to_origin"}
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - TIMING: Using EventReactor arrival time=1770338762732 for seqID=2070000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770338762706 for seqID=2070000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Sequence ID: 2070000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service: RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770338762732
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Invocation Time: 1770338762973
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Publish Time: 1770338763246
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770338762706
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 2070000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 241ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service Time: 273ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Total Time: 514ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 2070000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service RadiologyService sequence ID: 2070000 complete.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: token = {"notAfter":1770338885106,"tokenId":"2080000","data":{},"workflow_start_time":1770338765106,"currentPlace":"RadiologyService","version":"v002"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770338765106 for seqID=2080000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 2080000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v002
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - FILTER: Event for RadiologyService.federatedRadiologyRequest accepted by RadiologyService thread
WARN ServiceThread-RadiologyService-12102 org.btsn.json.jsonLibrary - Key "token" already exists. Skipping.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=token to join 2080000 (tokenId=2080000, mapSize=1)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Radiology/RuleFolder.v002/federatedRadiologyRequest/Service.ruleml
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v002
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2080000 buffered at T_in_RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - GENERATED: Token 2080000 from FEDERATED_RADIOLOGY_REQUEST at 1770338765106 -> RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: FEDERATED_RADIOLOGY_REQUEST token=2080000 eventType=GENERATED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2080000 eventType=BUFFERED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2080000  -> RadiologyService [BUFFERED] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2080000 BUFFERED at RadiologyService (T_in arrival)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2080000 entering place: RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2080000 eventType=ENTER
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2080000  -> RadiologyService [ENTER] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2080000 ENTER at RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service RadiologyService:federatedRadiologyRequest executing with trigger token (no workflow data required)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling RadiologyService.federatedRadiologyRequest immediately
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking RadiologyService.federatedRadiologyRequest via ServiceHelper (canonical binding)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SequenceID: 2080000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 143
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: First service - raw token IS original_token
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770338765106
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 143 (removed 0 bytes of metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.RadiologyService.federatedRadiologyRequest with 1 CLEAN business data arguments
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Calling federatedRadiologyRequest with 1 arguments
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.RadiologyService.federatedRadiologyRequest completed in 97ms
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Output attribute 'radiologyResults' not found in service result, cannot enrich
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"RAD_PLACE_2080000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338885106,"marking":0,"tokenId":"2080000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104605_2062","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338765106,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2080000","version":"v002","sequenceId":"2080000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2080000_5640","external_hospital":"EXTERNAL_HOSPITAL_638","federated_timestamp":1770338765640,"cross_facility_audit":true,"result_routing":"return_to_origin"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2080000 exiting place: RadiologyService -> MonitorService [arc=$ANON11]
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_out_RadiologyService token=2080000 eventType=EXIT
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_out_RadiologyService (EdgeNode) token=2080000 RadiologyService -> MonitorService [EXIT] arc=$ANON11
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2080000 EXIT from RadiologyService -> MonitorService.acknowledgeTokenArrival [arc=$ANON11]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Querying activeService for MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService query returned 2 rows
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?channelId = ip0
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: ActiveService result - ?port = 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: APPLYING activeService override - Channel: ip0, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Resolved ip0 to IP 192.168.1.152
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: External to MonitorService -> 'radiologyResults'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ROUTING: Token 2080000 -> 'radiologyResults' to MonitorService.acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Publishing to Service MonitorService Operation: acknowledgeTokenArrival
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Channel: 192.168.1.152, Port: 3000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Attribute radiologyResults = {"RAD_PLACE_2080000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338885106,"marking":0,"tokenId":"2080000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104605_2062","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338765106,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2080000","version":"v002","sequenceId":"2080000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2080000_5640","external_hospital":"EXTERNAL_HOSPITAL_638","federated_timestamp":1770338765640,"cross_facility_audit":true,"result_routing":"return_to_origin"}
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Completed callNextOperation for MonitorService, published=true
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Successfully published to MonitorService via EventPublisher
ERROR ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - monitorIncomingEvents: true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - TIMING: Using EventReactor arrival time=1770338765143 for seqID=2080000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - WRITE: Using captured workflowStartTime=1770338765106 for seqID=2080000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - === SERVICE TIMING RECORD ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Sequence ID: 2080000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service: RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Arrival Time (EventReactor): 1770338765143
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Invocation Time: 1770338765463
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Publish Time: 1770338765755
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Workflow Start Time: 1770338765106
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   MARKING: Buffer=0, Total=1, Capacity=50
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ==============================
INFO ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote service timing record for sequenceID: 2080000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Queue Time (including priority queue): 320ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Service Time: 292ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Total Time: 612ms
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread -   Buffer Utilization: 0.0%
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Cleaned up join 2080000
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Service RadiologyService sequence ID: 2080000 complete.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing:: token = {"notAfter":1770338887506,"tokenId":"2090000","data":{},"workflow_start_time":1770338767506,"currentPlace":"RadiologyService","version":"v002"}
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CAPTURE: WorkflowStartTime=1770338767506 for seqID=2090000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Incoming Sequence ID = 2090000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - MonitorIncomingEvents+ = true
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - Using RuleBaseVersion: v002
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - FILTER: Event for RadiologyService.federatedRadiologyRequest accepted by RadiologyService thread
WARN ServiceThread-RadiologyService-12102 org.btsn.json.jsonLibrary - Key "token" already exists. Skipping.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - JOIN-MAP: Added key=token to join 2090000 (tokenId=2090000, mapSize=1)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Loading rule base for operation: federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Rule base location: C:\DevShare\BTSN_R001\BTSN\btsn.healthcare.places.Radiology/RuleFolder.v002/federatedRadiologyRequest/Service.ruleml
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Using cached knowledge base for version: v002
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Parsing knowledge base...
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Knowledge base parsed successfully
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Canonical binding found - overriding serviceName facts
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Overrode inputCollection for canonical binding
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - decisionValueCollection already populated from publishes query - skipping legacy getDecisionValue
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2090000 buffered at T_in_RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - GENERATED: Token 2090000 from FEDERATED_RADIOLOGY_REQUEST at 1770338767506 -> RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: FEDERATED_RADIOLOGY_REQUEST token=2090000 eventType=GENERATED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2090000 eventType=BUFFERED
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2090000  -> RadiologyService [BUFFERED] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2090000 BUFFERED at RadiologyService (T_in arrival)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Token 2090000 entering place: RadiologyService (buffer=0)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Could not extract previousPlace from payload
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - NAMING CONVENTION VIOLATION: Service 'RadiologyService' does not end with '_Place'. Expected format: {NodeName}_Place. Transition IDs may not match topology. Please rename the service.
DEBUG ServiceThread-RadiologyService-12102 org.btsn.derby.Analysis.BuildServiceAnalysisDatabase - Wrote transition firing: T_in_RadiologyService token=2090000 eventType=ENTER
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.PetriNetInstrumentationHelper - Recorded transition: T_in_RadiologyService (EdgeNode) token=2090000  -> RadiologyService [ENTER] buffer=0
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - PETRI-NET: Token 2090000 ENTER at RadiologyService
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: About to check inputCollection.isEmpty() - size: 1
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection contents: [null]
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: nodeType: EdgeNode
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: needsInputSynchronization: false
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: Past inputCollection check, about to enter JOIN processing
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - DEBUG: inputCollection.get(0): null
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Zero-input service RadiologyService:federatedRadiologyRequest executing with trigger token (no workflow data required)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Processing EdgeNode for RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Processing EdgeNode/MergeNode for RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Checking canonical binding for RadiologyService.federatedRadiologyRequest with attribute 'token'
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: Operation federatedRadiologyRequest uses standard (AND) semantics
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest requires 1 inputs total (standard AND logic)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - CANONICAL-BINDING: federatedRadiologyRequest needs 1 input - can call immediately with 'token'
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Found single-input canonical binding - calling RadiologyService.federatedRadiologyRequest immediately
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceThread - ORCHESTRATOR: Invoking RadiologyService.federatedRadiologyRequest via ServiceHelper (canonical binding)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION START ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Service: org.btsn.places.RadiologyService.federatedRadiologyRequest
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SequenceID: 2090000
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Input arguments count: 1
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - Processing argument 1/1, raw length: 143
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: First service - raw token IS original_token
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted workflow_start_time=1770338767506
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Cleaned argument 1, length: 143 (removed 0 bytes of metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Extracted 1 clean business data arguments (removed infrastructure metadata)
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE INVOKE: Calling org.btsn.places.RadiologyService.federatedRadiologyRequest with 1 CLEAN business data arguments
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Reflecting on org.btsn.places.RadiologyService.federatedRadiologyRequest
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Looking for method with 1 String parameters
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Created instance using 1-param constructor (context) for org.btsn.places.RadiologyService
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Found standard method (1 String args)
DEBUG ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - INVOKE: Calling federatedRadiologyRequest with 1 arguments
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - SERVICE COMPLETE: org.btsn.places.RadiologyService.federatedRadiologyRequest completed in 102ms
WARN ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Output attribute 'radiologyResults' not found in service result, cannot enrich
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - ENRICHMENT: Successfully enriched service result with metadata
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.ServiceHelper - === SERVICE INVOCATION COMPLETE ===
INFO ServiceThread-RadiologyService-12102 org.btsn.handlers.TransitionHandler - ORCHESTRATOR: Service returned: {"RAD_PLACE_2090000":{"serviceType":"radiologyResults","executionTime":0,"notAfter":1770338887506,"marking":0,"tokenId":"2090000","data":{"imaging_type":"chest_xray","findings":"Normal cardiac silhouette, clear lung fields bilaterally","impression":"No acute cardiopulmonary abnormalities","study_id":"STUDY_unknown_20260206104608_8587","protocol_id":"CHEST_XR_01","radiologist":"DR_RAD_0","recommendations":"Clinical correlation recommended"},"workflow_start_time":1770338767506,"currentPlace":"RadiologyService","placeId":"RAD_PLACE_2090000","version":"v002","sequenceId":"2090000","status":"IMAGING_COMPLETE"},"federated_request_id":"FED_2090000_8033","external_hospital":"EXTERNAL_HOSPITAL_32","federated_timestamp":1770338768033,"cross_facility_audit":true,"result_routing":"return_to_origin"}
